FROM erseco/alpine-moodle:v5.0.0

USER root

# Install Xdebug cleanly without apk update
RUN apk add --no-cache php83-pecl-xdebug

# Copy Xdebug configuration
COPY xdebug.ini /etc/php83/conf.d/50_xdebug.ini

# Copy nginx configuration with fastcgi_read_timeout 300
COPY nginx.conf /etc/nginx/nginx.conf

# Switch back to nobody for security
USER nobody
